
# 半连接队列 和 全连接队列

在 TCP 三次握手的时候，Linux 内核会维护两个队列，分别是:

- 半连接队列，也称 SYN 队列; 
- 全连接队列，也称 accept 队列;

服务端收到客户端发起的 SYN 请求后，**内核会把该连接存储到半连接队列**，并向客户端响应 SYN+ACK，接着客户端会返回 ACK，服务端收到第三次握手的 ACK 后，**内核会把连接从半连接队列移除，然后创建新的完全的连接，并将其添加到 accept 队列**，等待进程调用 accept 函数时把连接取出来。

![](/uploads/upload_f2071792b96ab3e453a105a8fe44410b.png)

不管是半连接队列还是全连接队列，都有最大长度限制，超过限制时，内核会直接丢弃，或返回 RST 包。