# 进程通信

进程同步与进程通信很容易混淆，它们的区别在于：

- 进程同步：控制多个进程按一定顺序执行；
- 进程通信：进程间传输信息。

进程通信是一种手段，而进程同步是一种目的。也可以说，为了能够达到进程同步的目的，需要让进程进行通信，传输一些进程同步所需要的信息。

## 1. 管道(PIPE)

管道是通过调用 pipe 函数创建的，fd[0] 用于读，fd[1] 用于写。

```c
#include <unistd.h>
int pipe(int fd[2]);
```

它具有以下限制：

只支持半双工通信（单向交替传输）；
只能在父子进程中使用。

![](/uploads/upload_0ada70ebd9ed4256ed86c5031e9cbb44.png)

管道包括三种:
　　1)普通管道PIPE, 通常有种限制,一是半双工,只能单向传输;二是只能在父子进程间使用.
　　2)流管道s_pipe: 去除了第一种限制,可以双向传输. 
　　3)命名管道:name_pipe, 去除了第二种限制,可以在许多并不相关的进程之间进行通讯.
　　
## 2. FIFO

也称为命名管道，去除了管道只能在父子进程中使用的限制。

```c
#include <sys/stat.h>
int mkfifo(const char *path, mode_t mode);
int mkfifoat(int fd, const char *path, mode_t mode);
```

FIFO 常用于客户-服务器应用程序中，FIFO 用作汇聚点，在客户进程和服务器进程之间传递数据。

![](/uploads/upload_90998a0d90d6fe73d2fd57f199f90ce9.png)

## 3. 消息队列(message queue)

相比于 FIFO，消息队列具有以下优点：

消息队列可以独立于读写进程存在，从而避免了 FIFO 中同步管道的打开和关闭时可能产生的困难；
避免了 FIFO 的同步阻塞问题，不需要进程自己提供同步方法；
读进程可以根据消息类型有选择地接收消息，而不像 FIFO 那样只能默认地接收。

## 4. 信号量(semophore)
它是一个计数器，用于为多个进程提供对共享数据对象的访问。

## 5. 共享存储(shared memory)
允许多个进程共享一个给定的存储区。因为数据不需要在进程之间复制，所以这是最快的一种 IPC。

需要使用信号量用来同步对共享存储的访问。

多个进程可以将同一个文件映射到它们的地址空间从而实现共享内存。另外 XSI 共享内存不是使用文件，而是使用使用内存的匿名段。

## 6. 信号 ( sinal )

 信号是一种比较复杂的通信方式，用于通知接收进程某个事件已经发生。

## 7. 内存映射

内存映射允许任何多个进程间通信，每一个使用该机制的进程通过把一个共享的文件映射到自己的进程地址空间来实现它.

## 8. 套接字(SOCKET)
与其它通信机制不同的是，它可用于不同机器间的进程通信。