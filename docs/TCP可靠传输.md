
# CP可靠传输


TCP/IP可靠传输的基础是滑动窗口协议和连续ARQ协议，配合着流量控制和拥塞控制，使得整个传输过程保证：

传输信道不产生差错
不管发送方以多快的速度发送数据，接收方总是来得及处理收到的数据（通过累计确认、超时重传、拥塞控制三大模块保证）

## 停止等待协议和自动重传请求(ARQ)

所谓停止等待协议就是每发送完一个分组就停止发送，等待对方的确认。在收到确认后再发送下一个分组。但是在传输过程中可能出现意外，这时候就需要用到ARQ协议了

### B可能没有收到A发送的M1

这时候A就会有个超时计时器，当超时计时器到期时没收到B的确认报文，则A重新发送M1，因此必须保证以下几点：

A发送完一个分组后，必须暂时保留已发送的分组副本，只有收到确认后才能清除分组副本
分组和确认分组都必须进行编号
超时计时器设置的重传时间应当比数据在分组传输的往返时间更长一些

![](/uploads/upload_d10d58ed7e904f96670d19d496f73aa8.png)


## A没有收到B的确认报文或确认报文迟到

发生确认丢失时，B会再一次收到A的重传分组M1，此时B会进行如下行动：

丢弃这个重复分组M1
向A发送确认报文
发生确认迟到时，A会再一次收到B的确认报文，这时候A收下并丢弃这个确认报文，并不做什么。


![](/uploads/upload_6303f3ca4e869a4cb9a4d0c8c07ba764.png)


## 滑动窗口协议和连续ARQ协议

### 累积确认方式

为了提高信道的利用率，实际上采用了流水线传输的方案。如图：

![](/uploads/upload_5b5a246930f324e4f1f17386712e5856.png)


这时就需要使用连续ARQ协议和滑动窗口协议。发送方和接收方各自维持着发送窗口和接受窗口，发送方每收到一个确认，就把发送窗口向前滑动一个分组的位置。接收方一般采用累计确认方式，即接收方不必对收到的分组逐个发送确认，而是可以在收到几个分组后，对按序到达的最后一个分组发送确认，这样就表示：到这个分组位置的所有分组都已经正确收到了。

![](/uploads/upload_1d3b3961d3171df0aab4d9d6c703f525.png)

## [流量控制](TCP流量控制.md)

## [拥塞控制](TCP拥塞控制.md)