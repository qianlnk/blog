# HTTP版本比较

## HTTP特性

- 优点
    1. **简单**
    
        HTTP 基本的报文格式就是 header + body，头部信息也是 key-value 简单文本的形式，易于理解，降低了学习和使用的门槛。
        
    2. **灵活，易扩展**
        
        HTTP协议里的各类请求方法、URI/URL、状态码、头字段等每个组成要求都没有被固定死，都允许开发人员自定义和扩充。
        
        同时 HTTP 由于是工作在应用层（ OSI 第七层），则它下层可以随意变化。
    
        HTTPS 也就是在 HTTP 与 TCP 层之间增加了 SSL/TLS 安全传输层，HTTP/3 甚至把 TCP 层换成了基于 UDP 的 QUIC
        
    3. **应用广泛、跨平台**

- 缺点
    1. 无状态
        1. 好处：服务端不需要记录HTTP的状态，节约资源
        2. 坏处：既然服务器没有记忆能力，它在完成有关联性的操作时会非常麻烦，使用cookie技术解决。
    2. 明文传输
    3. 不安全

## 1. HTTP1.0 和 HTTP1.1区别

**HTTP1.0 短连接，每次请求都需要TCP三次握手，四次挥手。**
**HTTP1.1 加入长连接**

![](/uploads/upload_258017886ec006962c03c740facc202b.png)


可在同一个 TCP 连接里面，客户端可以发起多个请求，只要第一个请求发出去了，不必等其回来，就可以发第二个请求出去，可以减少整体的响应时间。

**HTTP1.1 支持管道网络传输**

![](/uploads/upload_94c7ee232e48ea45bbd2c5060d7363e0.png)



## HTTP1.1 和 HTTPS区别

1. HTTP是超文本传输协议，信息是明文传输的，存在安全风险的问题，HTTPS则解决HTTP不安全的问题，在TCP和HTTP层之间加了SSL/TLS安全协议，使得报文能够加密传输。

2. HTTP建立连接相对简单，TCP三次握手后便可以开始数据传输。而HTTPS则在三次握手之后还需要SSL/TLS四次握手后才能开始传输数据。

3. HTTP默认端口号80， HTTPS默认端口号443

4. HTTPS需要向CA申请数字证书，来保证服务身份可信。 

## HTTP1.1 和 HTTP2区别

首先HTTP1.1性能上还是有很多瓶颈：

- 请求/响应的header没有压缩，头部越大越慢，只有body有压缩。
- header冗长，而且每次请求发送还可能是一样的头部，资源浪费。
- 会出现队头阻塞问题，服务器是按请求的顺序响应的，如果服务器响应慢，会招致客户端一直请求不到数据。
- 请求没有优先级。
- 请求只能从客户端开始，服务端被动响应。


1. HTTP2基于HTTPS，所以HTTP2安全有保障。
2. 头部压缩

    HTTP2会进行头部压缩，同时发送的请求如果头部是一样的或者类似的，HTTP2会帮你去掉重复的部分。
    
   这就是HPACK算法：在客户端和服务器同时维护一张头信息表，所有字段都会存入这个表， 生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了。

3. 二进制格式
 
    HTTP/2 不再像 HTTP/1.1 里的纯文本形式的报文，而是全面采用了二进制格式，头信息和数据体都是二进制，并且统称为帧(frame):头信息帧和数据帧。

    ![](/uploads/upload_61adf5054f8f9b68e30d5e60cbb2d997.png)

4. 数据流

    HTTP/2 的数据包不是按顺序发送的，同一个连接里面连续的数据包，可能属于不同的回应。因此，必 须要对数据包做标记，指出它属于哪个回应。

    每个请求或回应的所有数据包，称为一个数据流( Stream )。每个数据流都标记着一个独一无二的编 号，其中规定客户端发出的数据流编号为奇数， 服务器发出的数据流编号为偶数

    客户端还可以指定数据流的优先级。优先级高的请求，服务器就先响应该请求。

5. 多路复用

    HTTP/2 是可以在一个连接中并发多个请求或回应，而不用按照顺序一一对应。

    移除了 HTTP/1.1 中的串行请求，不需要排队等待，也就不会再出现「队头阻塞」问题，降低了延迟，大幅度提高了连接的利用率。

    ![](/uploads/upload_5e4c1dc44d04632d649cc6c5132ed91f.png)

6. 服务端推送

    HTTP/2 还在一定程度上改善了传统的「请求 - 应答」工作模式，服务不再是被动地响应，也可以主动向客户端发送消息。

    举例来说，在浏览器刚请求 HTML 的时候，就提前把可能会用到的 JS、CSS 文件等静态资源主动发给客户端，减少延时的等待，也就是服务器推送（Server Push，也叫 Cache Push）。

## HTTP2 和 HTTP3 区别

- HTTP/1.1 中的管道（ pipeline）传输中如果有一个请求阻塞了，那么队列后请求也统统被阻塞住了
- HTTP/2 多个请求复用一个TCP连接，一旦发生丢包，就会阻塞住所有的 HTTP 请求。

**HTTP/3 把 HTTP 下层的 TCP 协议改成了 UDP！**

![](/uploads/upload_6562f7d40ad13be6224ccdbae4cb3a84.png)

UDP不管顺序也不管丢包，所以不会出现HTTP1.1的队头阻塞问题也不会发生HTTP2的一个包丢失所有请求都等这个包重传的问题。

但是要实现可靠传输，HTTP3引入了QUIC协议。

- QUIC 有自己的一套机制可以保证传输的可靠性的。当某个流发生丢包时，只会阻塞这个流，其他流不会受到影响。

- TLS升级成了最新的 1.3 版本，头部压缩算法也升级成了 QPack 。

- HTTPS 要建立一个连接，要花费 6 次交互，先是建立三次握手，然后是 TLS/1.3 的三次握手。 QUIC 直接把以往的 TCP 和 TLS/1.3 的 6 次交互合并成了 3 次，减少了交互次数。

![](/uploads/upload_27a3ebc3d6c259bb7b940ddef9cabfd0.png)
